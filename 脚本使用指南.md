# ğŸ› ï¸ MatrixTools è„šæœ¬ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æˆ‘å·²ç»ä¸ºæ‚¨æ•´åˆäº†æ‰€æœ‰è„šæœ¬ï¼Œåˆ›å»ºäº†ä¸€ä¸ªç»Ÿä¸€çš„ç®¡ç†å·¥å…·ï¼Œé¿å…äº†ä¹‹å‰å¤šä¸ªè„šæœ¬ä¹‹é—´çš„å†²çªé—®é¢˜ã€‚ç°åœ¨æ‚¨å¯ä»¥é€šè¿‡ä¸€ä¸ªè„šæœ¬ç®¡ç†å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„æ‰€æœ‰æ“ä½œã€‚

## ğŸ”§ è„šæœ¬æ•´åˆè¯´æ˜

### æ•´åˆå‰çš„é—®é¢˜
- âŒ **å¤šä¸ªè„šæœ¬å†²çª**ï¼š`pm2.sh`ã€`production.sh`ã€`restart-service.sh` åŠŸèƒ½é‡å 
- âŒ **è·¯å¾„ä¸ä¸€è‡´**ï¼šä¸åŒè„šæœ¬ä¸­çš„è·¯å¾„é…ç½®ä¸ç»Ÿä¸€
- âŒ **åŠŸèƒ½åˆ†æ•£**ï¼šå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒæ“ä½œåˆ†æ•£åœ¨ä¸åŒæ–‡ä»¶
- âŒ **ç»´æŠ¤å›°éš¾**ï¼šä¿®æ”¹é…ç½®éœ€è¦åŒæ­¥å¤šä¸ªæ–‡ä»¶

### æ•´åˆåçš„ä¼˜åŠ¿
- âœ… **ç»Ÿä¸€å…¥å£**ï¼š`scripts/manage.sh` ä¸€ä¸ªè„šæœ¬ç®¡ç†æ‰€æœ‰æ“ä½œ
- âœ… **ç¯å¢ƒåˆ†ç¦»**ï¼šæ˜ç¡®åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ
- âœ… **æ™ºèƒ½æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹ PM2ã€sudo æƒé™ç­‰ä¾èµ–
- âœ… **æ— å†²çªè®¾è®¡**ï¼šå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒç«¯å£ã€è¿›ç¨‹å®Œå…¨åˆ†ç¦»
- âœ… **è¯¦ç»†æ—¥å¿—**ï¼šå½©è‰²è¾“å‡ºï¼Œæ¸…æ™°çš„æ“ä½œåé¦ˆ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
```bash
# æ£€æŸ¥ç³»ç»Ÿä¾èµ–å’Œå½“å‰çŠ¶æ€
./scripts/manage.sh status
```

### 2. å¼€å‘ç¯å¢ƒæ“ä½œ
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
./scripts/manage.sh dev start

# åœæ­¢å¼€å‘æœåŠ¡å™¨
./scripts/manage.sh dev stop

# é‡å¯å¼€å‘æœåŠ¡å™¨
./scripts/manage.sh dev restart

# æ¸…ç†å¼€å‘ç¯å¢ƒç¼“å­˜
./scripts/manage.sh dev clean

# ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–
./scripts/manage.sh dev lint
./scripts/manage.sh dev format
```

### 3. ç”Ÿäº§ç¯å¢ƒæ“ä½œ
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
./scripts/manage.sh prod build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡
./scripts/manage.sh prod start

# æŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒçŠ¶æ€
./scripts/manage.sh prod status

# é‡å¯ç”Ÿäº§æœåŠ¡ï¼ˆæ”¯æŒé›¶åœæœºé‡å¯ï¼‰
./scripts/manage.sh prod restart

# æŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒæ—¥å¿—
./scripts/manage.sh prod logs

# ä¸€é”®éƒ¨ç½²ï¼ˆæ„å»º+å¯åŠ¨+å¥åº·æ£€æŸ¥ï¼‰
./scripts/manage.sh prod deploy
```

## ğŸ“¦ npm è„šæœ¬å¿«æ·æ–¹å¼

ä¸ºäº†æ›´ä¾¿æ·çš„ä½¿ç”¨ï¼Œæˆ‘è¿˜åœ¨ `package.json` ä¸­æ·»åŠ äº†å¿«æ·å‘½ä»¤ï¼š

### å¼€å‘ç¯å¢ƒå¿«æ·æ–¹å¼
```bash
npm run dev:start    # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev:stop     # åœæ­¢å¼€å‘æœåŠ¡å™¨
npm run dev:clean    # æ¸…ç†å¼€å‘ç¼“å­˜
```

### ç”Ÿäº§ç¯å¢ƒå¿«æ·æ–¹å¼
```bash
npm run prod:build   # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run prod:start   # å¯åŠ¨ç”Ÿäº§æœåŠ¡
npm run prod:deploy  # ä¸€é”®éƒ¨ç½²
npm run prod:status  # æŸ¥çœ‹çŠ¶æ€
```

### å…¶ä»–æœ‰ç”¨å‘½ä»¤
```bash
npm run clean        # æ¸…ç†æ„å»ºæ–‡ä»¶
npm run lint:fix     # è‡ªåŠ¨ä¿®å¤ä»£ç é—®é¢˜
npm run type-check   # TypeScript ç±»å‹æ£€æŸ¥
npm run system:status # ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
```

## ğŸ”„ ç¯å¢ƒåˆ†ç¦»è®¾è®¡

### å¼€å‘ç¯å¢ƒç‰¹ç‚¹
- **ç«¯å£**: é»˜è®¤ 3000ï¼Œæ”¯æŒçƒ­é‡è½½
- **è¿›ç¨‹**: `next dev --turbopack`
- **åœæ­¢æ–¹å¼**: ç»ˆæ­¢å¼€å‘æœåŠ¡å™¨è¿›ç¨‹
- **é€‚ç”¨åœºæ™¯**: æ—¥å¸¸å¼€å‘ã€è°ƒè¯•ã€åŠŸèƒ½æµ‹è¯•

### ç”Ÿäº§ç¯å¢ƒç‰¹ç‚¹
- **ç«¯å£**: 3000ï¼ˆå¯é…ç½®ï¼‰
- **è¿›ç¨‹**: `npm start` æˆ– PM2 ç®¡ç†
- **åœæ­¢æ–¹å¼**: ä¼˜é›…å…³é—­ï¼Œæ”¯æŒé›¶åœæœºé‡å¯
- **é€‚ç”¨åœºæ™¯**: æ­£å¼éƒ¨ç½²ã€ç”¨æˆ·è®¿é—®

### æ™ºèƒ½å†²çªå¤„ç†
```bash
# è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹ç«¯å£å ç”¨
âœ… å¼€å‘ç¯å¢ƒå¯åŠ¨å‰æ£€æŸ¥ç«¯å£ 3000
âœ… ç”Ÿäº§ç¯å¢ƒå¯åŠ¨å‰åœæ­¢å¼€å‘æœåŠ¡å™¨
âœ… è¿›ç¨‹ä¼˜é›…å…³é—­ï¼Œé¿å…åƒµå°¸è¿›ç¨‹
```

## âš™ï¸ è¿›ç¨‹ç®¡ç†å¯¹æ¯”

| åŠŸèƒ½ | ç›´æ¥å¯åŠ¨ | PM2 ç®¡ç† | æ¨èåœºæ™¯ |
|------|----------|----------|----------|
| **è¿›ç¨‹ç›‘æ§** | âŒ | âœ… | PM2 æ›´é€‚åˆç”Ÿäº§ |
| **è‡ªåŠ¨é‡å¯** | âŒ | âœ… | PM2 æä¾›æ•…éšœæ¢å¤ |
| **é›¶åœæœºé‡å¯** | âŒ | âœ… | PM2 æ”¯æŒçƒ­é‡è½½ |
| **æ—¥å¿—ç®¡ç†** | ç®€å• | å®Œå–„ | PM2 æä¾›è½®è½¬ |
| **é›†ç¾¤æ¨¡å¼** | âŒ | âœ… | PM2 æ”¯æŒè´Ÿè½½å‡è¡¡ |
| **ç³»ç»Ÿèµ„æº** | ä½ | ä¸­ç­‰ | æ ¹æ®éœ€æ±‚é€‰æ‹© |

## ğŸ“Š ç³»ç»ŸæœåŠ¡é›†æˆ

### å®‰è£…å¼€æœºè‡ªå¯æœåŠ¡
```bash
# å®‰è£… systemd æœåŠ¡ï¼ˆéœ€è¦ sudo æƒé™ï¼‰
./scripts/manage.sh install-service

# ä¹‹åå¯ä»¥ä½¿ç”¨ç³»ç»Ÿå‘½ä»¤ç®¡ç†
sudo systemctl start matrixtools
sudo systemctl stop matrixtools
sudo systemctl restart matrixtools
sudo systemctl status matrixtools
```

### æœåŠ¡ç®¡ç†å±‚çº§
```
1. systemd (ç³»ç»Ÿçº§)
   â†“
2. PM2 (è¿›ç¨‹çº§)
   â†“
3. Node.js App (åº”ç”¨çº§)
```

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :3000

# ä½¿ç”¨è„šæœ¬è‡ªåŠ¨å¤„ç†
./scripts/manage.sh dev start  # ä¼šæç¤ºæ˜¯å¦åœæ­¢å ç”¨è¿›ç¨‹
```

#### 2. è¿›ç¨‹æ®‹ç•™
```bash
# è„šæœ¬ä¼šè‡ªåŠ¨æ¸…ç†æ®‹ç•™è¿›ç¨‹
./scripts/manage.sh dev stop   # å¼ºåˆ¶æ¸…ç†å¼€å‘è¿›ç¨‹
./scripts/manage.sh prod stop  # ä¼˜é›…å…³é—­ç”Ÿäº§è¿›ç¨‹
```

#### 3. æ„å»ºå¤±è´¥
```bash
# æ¸…ç†ç¼“å­˜åé‡æ–°æ„å»º
./scripts/manage.sh dev clean
./scripts/manage.sh prod build
```

#### 4. PM2 æœåŠ¡å¼‚å¸¸
```bash
# æ£€æŸ¥ PM2 çŠ¶æ€
pm2 list
pm2 logs matrixtools-web

# é‡ç½® PM2
pm2 kill
./scripts/manage.sh prod start
```

## ğŸ“ é…ç½®æ–‡ä»¶è¯´æ˜

### ä¸»è¦é…ç½®æ–‡ä»¶
- `scripts/manage.sh` - ç»Ÿä¸€ç®¡ç†è„šæœ¬
- `config/ecosystem.config.js` - PM2 é…ç½®
- `package.json` - npm è„šæœ¬é…ç½®

### ç¯å¢ƒå˜é‡
```bash
# å¼€å‘ç¯å¢ƒ
NODE_ENV=development

# ç”Ÿäº§ç¯å¢ƒ
NODE_ENV=production
PORT=3000
```

### æ—¥å¿—æ–‡ä»¶ä½ç½®
```
logs/
â”œâ”€â”€ combined.log    # PM2 æ··åˆæ—¥å¿—
â”œâ”€â”€ out.log        # æ ‡å‡†è¾“å‡ºæ—¥å¿—
â”œâ”€â”€ error.log      # é”™è¯¯æ—¥å¿—
â””â”€â”€ app.log        # ç›´æ¥å¯åŠ¨æ¨¡å¼æ—¥å¿—
```

## ğŸ¯ æœ€ä½³å®è·µ

### å¼€å‘æµç¨‹
1. `./scripts/manage.sh status` - æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
2. `./scripts/manage.sh dev start` - å¯åŠ¨å¼€å‘æœåŠ¡å™¨
3. è¿›è¡Œå¼€å‘å’Œè°ƒè¯•
4. `./scripts/manage.sh dev lint` - ä»£ç æ£€æŸ¥
5. `./scripts/manage.sh dev format` - ä»£ç æ ¼å¼åŒ–
6. `./scripts/manage.sh dev stop` - åœæ­¢å¼€å‘æœåŠ¡å™¨

### éƒ¨ç½²æµç¨‹
1. `./scripts/manage.sh prod stop` - åœæ­¢ç°æœ‰æœåŠ¡
2. `git pull origin main` - æ‹‰å–æœ€æ–°ä»£ç 
3. `./scripts/manage.sh prod deploy` - ä¸€é”®éƒ¨ç½²
4. `./scripts/manage.sh prod status` - æ£€æŸ¥éƒ¨ç½²çŠ¶æ€
5. è®¿é—® http://localhost:3000 éªŒè¯æœåŠ¡

### ç›‘æ§å’Œç»´æŠ¤
```bash
# å®šæœŸæ£€æŸ¥ç³»ç»ŸçŠ¶æ€
./scripts/manage.sh status

# æŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒè¿è¡ŒçŠ¶æ€
./scripts/manage.sh prod status

# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
./scripts/manage.sh prod logs

# æ€§èƒ½ç›‘æ§ï¼ˆå¦‚æœä½¿ç”¨ PM2ï¼‰
pm2 monit
```

## âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å¼€å‘ç¯å¢ƒ
- ä½¿ç”¨ Turbopack åŠ é€Ÿæ„å»º
- å®šæœŸæ¸…ç†ç¼“å­˜ï¼š`./scripts/manage.sh dev clean`
- å…³é—­ä¸å¿…è¦çš„æµè§ˆå™¨æ ‡ç­¾é¡µ

### ç”Ÿäº§ç¯å¢ƒ
- ä½¿ç”¨ PM2 é›†ç¾¤æ¨¡å¼ï¼ˆå¤šæ ¸ CPUï¼‰
- é…ç½®åå‘ä»£ç†ï¼ˆNginxï¼‰
- å¯ç”¨ gzip å‹ç¼©
- è®¾ç½®åˆç†çš„å†…å­˜é™åˆ¶

### é…ç½®ç¤ºä¾‹
```javascript
// ecosystem.config.js - é›†ç¾¤æ¨¡å¼
{
  instances: 'max',        // ä½¿ç”¨æ‰€æœ‰ CPU æ ¸å¿ƒ
  exec_mode: 'cluster',    // é›†ç¾¤æ¨¡å¼
  max_memory_restart: '1G' // å†…å­˜é™åˆ¶
}
```

é€šè¿‡è¿™å¥—æ•´åˆçš„è„šæœ¬ç³»ç»Ÿï¼Œæ‚¨å¯ä»¥æ›´é«˜æ•ˆã€æ›´å®‰å…¨åœ°ç®¡ç† MatrixTools é¡¹ç›®çš„å¼€å‘å’Œéƒ¨ç½²æµç¨‹ï¼